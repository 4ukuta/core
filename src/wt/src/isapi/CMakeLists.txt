IF(CONNECTOR_ISAPI)
  IF(NOT MULTI_THREADED)
    MESSAGE("** Disabling ISAPI because MULTI_THREADED is disabled.")
  ELSE(NOT MULTI_THREADED)
    MESSAGE("** Enabling ISAPI.")

    ADD_DEFINITIONS(-D_WIN32_WINNT=0x0501)

    SET(libsapisources
      Server.C
      Isapi.C
      IsapiRequest.C
      IsapiStream.C
    )

    INCLUDE_DIRECTORIES(${FCGI_INCLUDE_DIRS})
    ADD_LIBRARY(wtisapi ${libsapisources})
    TARGET_LINK_LIBRARIES(wtisapi wt)

    SET_TARGET_PROPERTIES(
      wtisapi
    PROPERTIES
      VERSION ${VERSION_SERIES}.${VERSION_MAJOR}.${VERSION_MINOR}
      SOVERSION ${WTISAPI_SOVERSION}
      DEBUG_POSTFIX "d"
    )

    INSTALL(TARGETS wtisapi
      RUNTIME DESTINATION bin
      LIBRARY DESTINATION ${LIB_INSTALL_DIR}
      ARCHIVE DESTINATION ${LIB_INSTALL_DIR})
    ENDIF(NOT MULTI_THREADED)
ELSE(CONNECTOR_ISAPI)
  MESSAGE("** Disabling ISAPI.")
ENDIF(CONNECTOR_ISAPI)

