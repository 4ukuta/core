<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Wt: Wt::Dbo::Session Class Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.6 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="namespaceWt.html">Wt</a>::<a class="el" href="namespaceWt_1_1Dbo.html">Dbo</a>::<a class="el" href="classWt_1_1Dbo_1_1Session.html">Session</a>
  </div>
</div>
<div class="contents">
<h1>Wt::Dbo::Session Class Reference<br>
<small>
[<a class="el" href="group__dbo.html">Database Objects (Dbo)</a>]</small>
</h1><!-- doxytag: class="Wt::Dbo::Session" -->A database session.  
<a href="#_details">More...</a>
<p>
<code>#include &lt;Wt/Dbo/Session&gt;</code>
<p>

<p>
<a href="classWt_1_1Dbo_1_1Session-members.html">List of all members.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="55c41a33e862729b80837347da199b20"></a><!-- doxytag: member="Wt::Dbo::Session::Session" ref="55c41a33e862729b80837347da199b20" args="()" -->
&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWt_1_1Dbo_1_1Session.html#55c41a33e862729b80837347da199b20">Session</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Creates a database session. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWt_1_1Dbo_1_1Session.html#ac2f9332076fff93cde45ba1c8d15fa3">~Session</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Destructor.  <a href="#ac2f9332076fff93cde45ba1c8d15fa3"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWt_1_1Dbo_1_1Session.html#edcc21944ce9c2bbb2fe2b5ef1860776">setConnection</a> (<a class="el" href="classWt_1_1Dbo_1_1SqlConnection.html">SqlConnection</a> &amp;connection)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Sets a dedicated connection.  <a href="#edcc21944ce9c2bbb2fe2b5ef1860776"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWt_1_1Dbo_1_1Session.html#63ab17e16c9b721c94e6e9f67c5c255d">setConnectionPool</a> (<a class="el" href="classWt_1_1Dbo_1_1SqlConnectionPool.html">SqlConnectionPool</a> &amp;pool)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Sets a connection pool.  <a href="#63ab17e16c9b721c94e6e9f67c5c255d"></a><br></td></tr>
<tr><td class="memTemplParams" nowrap colspan="2">template&lt;class C&gt; </td></tr>
<tr><td class="memTemplItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classWt_1_1Dbo_1_1Session.html#5886d450c052ae0ee15ab3c91e439229">mapClass</a> (const char *tableName)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Maps a class to a database table.  <a href="#5886d450c052ae0ee15ab3c91e439229"></a><br></td></tr>
<tr><td class="memTemplParams" nowrap colspan="2">template&lt;class C&gt; </td></tr>
<tr><td class="memTemplItemLeft" nowrap align="right" valign="top">const char *&nbsp;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classWt_1_1Dbo_1_1Session.html#a2455d5d0eb1b70b5a48b15ab4f9dd36">tableName</a> () const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns the mapped table name for a class.  <a href="#a2455d5d0eb1b70b5a48b15ab4f9dd36"></a><br></td></tr>
<tr><td class="memTemplParams" nowrap colspan="2">template&lt;class C&gt; </td></tr>
<tr><td class="memTemplItemLeft" nowrap align="right" valign="top"><a class="el" href="classWt_1_1Dbo_1_1ptr.html">ptr</a>&lt; C &gt;&nbsp;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classWt_1_1Dbo_1_1Session.html#1ffa672cd86ff1ce6d59837b05081946">add</a> (<a class="el" href="classWt_1_1Dbo_1_1ptr.html">ptr</a>&lt; C &gt; &amp;<a class="el" href="classWt_1_1Dbo_1_1ptr.html">ptr</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Persists a transient object.  <a href="#1ffa672cd86ff1ce6d59837b05081946"></a><br></td></tr>
<tr><td class="memTemplParams" nowrap colspan="2">template&lt;class C&gt; </td></tr>
<tr><td class="memTemplItemLeft" nowrap align="right" valign="top"><a class="el" href="classWt_1_1Dbo_1_1ptr.html">ptr</a>&lt; C &gt;&nbsp;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classWt_1_1Dbo_1_1Session.html#e255e99ca81e9642f52f20adc6fb752c">add</a> (C *obj)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Persists a transient object.  <a href="#e255e99ca81e9642f52f20adc6fb752c"></a><br></td></tr>
<tr><td class="memTemplParams" nowrap colspan="2">template&lt;class C&gt; </td></tr>
<tr><td class="memTemplItemLeft" nowrap align="right" valign="top"><a class="el" href="classWt_1_1Dbo_1_1ptr.html">ptr</a>&lt; C &gt;&nbsp;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classWt_1_1Dbo_1_1Session.html#857714c785108435d082bcad10158e68">load</a> (const typename <a class="el" href="structWt_1_1Dbo_1_1dbo__traits.html">dbo_traits</a>&lt; C &gt;::IdType &amp;id)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Loads a persisted object.  <a href="#857714c785108435d082bcad10158e68"></a><br></td></tr>
<tr><td class="memTemplParams" nowrap colspan="2">template&lt;class C, typename BindStrategy = DynamicBinding&gt; </td></tr>
<tr><td class="memTemplItemLeft" nowrap align="right" valign="top"><a class="el" href="classWt_1_1Dbo_1_1Query.html">Query</a>&lt; <a class="el" href="classWt_1_1Dbo_1_1ptr.html">ptr</a>&lt; C &gt;, BindStrategy &gt;&nbsp;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classWt_1_1Dbo_1_1Session.html#637d1031ffddd4bd7bbb55a616192ac7">find</a> (const std::string &amp;condition=std::string())</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Finds database objects.  <a href="#637d1031ffddd4bd7bbb55a616192ac7"></a><br></td></tr>
<tr><td class="memTemplParams" nowrap colspan="2">template&lt;class Result, typename BindStrategy = DynamicBinding&gt; </td></tr>
<tr><td class="memTemplItemLeft" nowrap align="right" valign="top"><a class="el" href="classWt_1_1Dbo_1_1Query.html">Query</a>&lt; Result, BindStrategy &gt;&nbsp;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classWt_1_1Dbo_1_1Session.html#8712ff0d59f7bb6a4d2986ad9637cc9e">query</a> (const std::string &amp;sql)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Creates a query.  <a href="#8712ff0d59f7bb6a4d2986ad9637cc9e"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="classWt_1_1Dbo_1_1Call.html">Call</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWt_1_1Dbo_1_1Session.html#42b1d61b66e996eff474d677a10d5b8f">execute</a> (const std::string &amp;sql)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Executs an Sql command.  <a href="#42b1d61b66e996eff474d677a10d5b8f"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWt_1_1Dbo_1_1Session.html#ba79d84c7c91faae06f954e6d3d390ab">createTables</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Creates the database schema.  <a href="#ba79d84c7c91faae06f954e6d3d390ab"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWt_1_1Dbo_1_1Session.html#4c1fedb21e4e1cc44b182a34e8ebb4ef">dropTables</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Drops the database schema.  <a href="#4c1fedb21e4e1cc44b182a34e8ebb4ef"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWt_1_1Dbo_1_1Session.html#b896d119f1e0fb79adffe2282b92ef17">flush</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Flushes the session.  <a href="#b896d119f1e0fb79adffe2282b92ef17"></a><br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
A database session. 
<p>
A database session manages meta data about the mapping of C++ classes to database tables, and keeps track of a working set of in-memory objects (objects which are referenced from your code or from within a transaction).<p>
It also manages an active transaction, which you need to access database objects.<p>
You can provide the session with a dedicated database connection using <a class="el" href="classWt_1_1Dbo_1_1Session.html#edcc21944ce9c2bbb2fe2b5ef1860776" title="Sets a dedicated connection.">setConnection()</a>, or with a connection pool (from which it will take a connection while processing a transaction) using <a class="el" href="classWt_1_1Dbo_1_1Session.html#63ab17e16c9b721c94e6e9f67c5c255d" title="Sets a connection pool.">setConnectionPool()</a>. In either case, the session does not take ownership of the connection or connection pool.<p>
A session will typically be a long-lived object in your application. <hr><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" name="ac2f9332076fff93cde45ba1c8d15fa3"></a><!-- doxytag: member="Wt::Dbo::Session::~Session" ref="ac2f9332076fff93cde45ba1c8d15fa3" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Wt::Dbo::Session::~Session           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Destructor. 
<p>
A session must survive all database objects that have been loaded through it, and will warning during this destructor if there are still database objects that are being referenced from a <a class="el" href="classWt_1_1Dbo_1_1ptr.html" title="A smart pointer for database objects.">ptr</a>. 
</div>
</div><p>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="edcc21944ce9c2bbb2fe2b5ef1860776"></a><!-- doxytag: member="Wt::Dbo::Session::setConnection" ref="edcc21944ce9c2bbb2fe2b5ef1860776" args="(SqlConnection &amp;connection)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Wt::Dbo::Session::setConnection           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classWt_1_1Dbo_1_1SqlConnection.html">SqlConnection</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>connection</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Sets a dedicated connection. 
<p>
The connection will be used exclusively by this session.<p>
<dl class="see" compact><dt><b>See also:</b></dt><dd><a class="el" href="classWt_1_1Dbo_1_1Session.html#63ab17e16c9b721c94e6e9f67c5c255d" title="Sets a connection pool.">setConnectionPool()</a> </dd></dl>

</div>
</div><p>
<a class="anchor" name="63ab17e16c9b721c94e6e9f67c5c255d"></a><!-- doxytag: member="Wt::Dbo::Session::setConnectionPool" ref="63ab17e16c9b721c94e6e9f67c5c255d" args="(SqlConnectionPool &amp;pool)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Wt::Dbo::Session::setConnectionPool           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classWt_1_1Dbo_1_1SqlConnectionPool.html">SqlConnectionPool</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>pool</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Sets a connection pool. 
<p>
The connection pool is typically shared with other sessions.<p>
<dl class="see" compact><dt><b>See also:</b></dt><dd><a class="el" href="classWt_1_1Dbo_1_1Session.html#edcc21944ce9c2bbb2fe2b5ef1860776" title="Sets a dedicated connection.">setConnection()</a> </dd></dl>

</div>
</div><p>
<a class="anchor" name="5886d450c052ae0ee15ab3c91e439229"></a><!-- doxytag: member="Wt::Dbo::Session::mapClass" ref="5886d450c052ae0ee15ab3c91e439229" args="(const char *tableName)" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class C&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void Wt::Dbo::Session::mapClass           </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>tableName</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Maps a class to a database table. 
<p>
The class <code>C</code> is mapped to table with name <code>tableName</code>. You need to map classes to tables.<p>
You may provide a schema-qualified table name, if the underlying database supports this, eg. <code>"myschema.users"</code>. 
</div>
</div><p>
<a class="anchor" name="a2455d5d0eb1b70b5a48b15ab4f9dd36"></a><!-- doxytag: member="Wt::Dbo::Session::tableName" ref="a2455d5d0eb1b70b5a48b15ab4f9dd36" args="() const " -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class C&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">const char * Wt::Dbo::Session::tableName           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Returns the mapped table name for a class. 
<p>
<dl class="see" compact><dt><b>See also:</b></dt><dd><a class="el" href="classWt_1_1Dbo_1_1Session.html#5886d450c052ae0ee15ab3c91e439229" title="Maps a class to a database table.">mapClass()</a> </dd></dl>

</div>
</div><p>
<a class="anchor" name="1ffa672cd86ff1ce6d59837b05081946"></a><!-- doxytag: member="Wt::Dbo::Session::add" ref="1ffa672cd86ff1ce6d59837b05081946" args="(ptr&lt; C &gt; &amp;ptr)" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class C&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classWt_1_1Dbo_1_1ptr.html">ptr</a>&lt; C &gt; Wt::Dbo::Session::add           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classWt_1_1Dbo_1_1ptr.html">ptr</a>&lt; C &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>ptr</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Persists a transient object. 
<p>
The transient object pointed to by <code><a class="el" href="classWt_1_1Dbo_1_1ptr.html" title="A smart pointer for database objects.">ptr</a></code> is added to the session, and will be persisted when the session is flushed.<p>
A transient object is usually a newly created object which want to add to the database.<p>
The method returns <code><a class="el" href="classWt_1_1Dbo_1_1ptr.html" title="A smart pointer for database objects.">ptr</a></code>. 
</div>
</div><p>
<a class="anchor" name="e255e99ca81e9642f52f20adc6fb752c"></a><!-- doxytag: member="Wt::Dbo::Session::add" ref="e255e99ca81e9642f52f20adc6fb752c" args="(C *obj)" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class C&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classWt_1_1Dbo_1_1ptr.html">ptr</a>&lt; C &gt; Wt::Dbo::Session::add           </td>
          <td>(</td>
          <td class="paramtype">C *&nbsp;</td>
          <td class="paramname"> <em>obj</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Persists a transient object. 
<p>
This is an overloaded method for convenience, and is implemented as: <div class="fragment"><pre class="fragment"> <span class="keywordflow">return</span> <span class="keyword">add</span>(ptr&lt;C&gt;(obj));
</pre></div><p>
The method returns a database pointer to the object. 
</div>
</div><p>
<a class="anchor" name="857714c785108435d082bcad10158e68"></a><!-- doxytag: member="Wt::Dbo::Session::load" ref="857714c785108435d082bcad10158e68" args="(const typename dbo_traits&lt; C &gt;::IdType &amp;id)" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class C&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classWt_1_1Dbo_1_1ptr.html">ptr</a>&lt; C &gt; Wt::Dbo::Session::load           </td>
          <td>(</td>
          <td class="paramtype">const typename <a class="el" href="structWt_1_1Dbo_1_1dbo__traits.html">dbo_traits</a>&lt; C &gt;::IdType &amp;&nbsp;</td>
          <td class="paramname"> <em>id</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Loads a persisted object. 
<p>
This method returns a database object with the given object id. If the object was already loaded in the session, the loaded object is returned, otherwise the object is loaded from the database.<p>
Throws an <a class="el" href="classWt_1_1Dbo_1_1ObjectNotFoundException.html" title="Exception thrown when trying to load a non-existing object.">ObjectNotFoundException</a> when the object was not found.<p>
<dl class="see" compact><dt><b>See also:</b></dt><dd><a class="el" href="classWt_1_1Dbo_1_1ptr.html#71d848cf0e8eaa1a4e01b11ae2f1e865" title="Returns the object id.">ptr::id()</a> </dd></dl>

</div>
</div><p>
<a class="anchor" name="637d1031ffddd4bd7bbb55a616192ac7"></a><!-- doxytag: member="Wt::Dbo::Session::find" ref="637d1031ffddd4bd7bbb55a616192ac7" args="(const std::string &amp;condition=std::string())" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class C, typename BindStrategy&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classWt_1_1Dbo_1_1Query.html">Query</a>&lt; <a class="el" href="classWt_1_1Dbo_1_1ptr.html">ptr</a>&lt; C &gt;, BindStrategy &gt; Wt::Dbo::Session::find           </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&nbsp;</td>
          <td class="paramname"> <em>condition</em> = <code>std::string()</code>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Finds database objects. 
<p>
This method creates a query for finding objects of type <code>C</code>.<p>
When passing an empty <code>condition</code> parameter, it will return all objects of type <code>C</code>. Otherwise, it will add the condition, by generating an SQL <em>where</em> clause.<p>
The <code>BindStrategy</code> specifies how you want to bind parameters to your query (if any).<p>
When using <code><a class="el" href="structWt_1_1Dbo_1_1DynamicBinding.html">DynamicBinding</a></code> (which is the default), you will defer the binding until the query is run. This has the advantage that you can compose the query definition using helper methods provided in the query object, you can keep the query around and run the query multiple times, perhaps with different parameter values or to scroll through the query results.<p>
When using <code><a class="el" href="structWt_1_1Dbo_1_1DirectBinding.html">DirectBinding</a></code>, the query must be specified entirely using the <code>condition</code>, and can be run only once. This method does have the benefit of binding parameters directly to the underlying prepared statement.<p>
This method is convenient when you are querying only results from a single table. For more generic query support, see <a class="el" href="classWt_1_1Dbo_1_1Session.html#8712ff0d59f7bb6a4d2986ad9637cc9e" title="Creates a query.">query()</a>.<p>
Usage example: <div class="fragment"><pre class="fragment"> <span class="comment">// Bart is missing, let's find him.</span>
 <a class="code" href="classWt_1_1Dbo_1_1ptr.html" title="A smart pointer for database objects.">Wt::Dbo::ptr&lt;User&gt;</a> bart = session.find&lt;User&gt;().where(<span class="stringliteral">"name = ?"</span>).bind(<span class="stringliteral">"Bart"</span>);

 <span class="comment">// Find all users, order by name</span>
 <span class="keyword">typedef</span> <a class="code" href="classWt_1_1Dbo_1_1collection.html" title="An STL container for iterating query results.">Wt::Dbo::collection&lt; Wt::Dbo::ptr&lt;User&gt;</a> &gt; Users;
 Users users = session.find&lt;User&gt;().orderBy(<span class="stringliteral">"name"</span>);
</pre></div><p>
<dl class="see" compact><dt><b>See also:</b></dt><dd><a class="el" href="classWt_1_1Dbo_1_1Session.html#8712ff0d59f7bb6a4d2986ad9637cc9e" title="Creates a query.">query()</a> </dd></dl>

</div>
</div><p>
<a class="anchor" name="8712ff0d59f7bb6a4d2986ad9637cc9e"></a><!-- doxytag: member="Wt::Dbo::Session::query" ref="8712ff0d59f7bb6a4d2986ad9637cc9e" args="(const std::string &amp;sql)" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class Result, typename BindStrategy&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classWt_1_1Dbo_1_1Query.html">Query</a>&lt; Result, BindStrategy &gt; Wt::Dbo::Session::query           </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&nbsp;</td>
          <td class="paramname"> <em>sql</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Creates a query. 
<p>
The sql statement should be a complete SQL statement, starting with a "select ". The items listed in the "select" must match the <code>Result</code> type. An item that corresponds to a database object (<a class="el" href="classWt_1_1Dbo_1_1ptr.html" title="A smart pointer for database objects.">ptr</a>) is substituted with the selection of all the fields in the dbo.<p>
For example, the following query (class User is mapped onto table 'user'): <div class="fragment"><pre class="fragment"> session.query&lt; ptr&lt;User&gt; &gt;(<span class="stringliteral">"select u from user u"</span>).where(<span class="stringliteral">"u.name = ?"</span>).bind(<span class="stringliteral">"Bart"</span>);
</pre></div> is the more general version of: <div class="fragment"><pre class="fragment"> session.find&lt;User&gt;().where(<span class="stringliteral">"name = ?"</span>).bind(<span class="stringliteral">"Bart"</span>);
</pre></div><p>
Note that "u" in this query will be expanded to select the fields of the user table (u.id, u.version, u.name, ...). The same expansion happens when using an alias in <a class="el" href="classWt_1_1Dbo_1_1Query.html#07d81e1a0d504eca1b428b04f7855c3d" title="Sets the grouping field(s).">Query::groupBy()</a>.<p>
The additional flexibility offered by query() over <a class="el" href="classWt_1_1Dbo_1_1Session.html#637d1031ffddd4bd7bbb55a616192ac7" title="Finds database objects.">find()</a> is however that it may support other result types.<p>
Thus, it may return plain values: <div class="fragment"><pre class="fragment"> session.query&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">"select count(1) from ..."</span>);
</pre></div><p>
Or Boost.Tuple for an arbitrary combination of result values:<p>
<div class="fragment"><pre class="fragment"> session.query&lt; boost::tuple&lt;int, int&gt; &gt;(<span class="stringliteral">"select A.id, B.id from table_a A, table_b B"</span>).where(<span class="stringliteral">"..."</span>);
</pre></div><p>
A tuple may combine any kind of object that is supported as a result, including database objects (see also <a class="el" href="structWt_1_1Dbo_1_1ptr__tuple.html" title="A utility class for defining a tuple of database objects.">ptr_tuple</a>): <div class="fragment"><pre class="fragment"> session.query&lt; boost::tuple&lt;ptr&lt;A&gt;, ptr&lt;B&gt; &gt;(<span class="stringliteral">"select A, B from table_a A, table_b B"</span>).where(<span class="stringliteral">"..."</span>);
</pre></div><p>
The <code>BindStrategy</code> specifies how you want to bind parameters to your query (if any).<p>
When using <code><a class="el" href="structWt_1_1Dbo_1_1DynamicBinding.html">DynamicBinding</a></code> (which is the default), you will defer the binding until the query is run. This has the advantage that you can compose the query using helper methods provided in the <a class="el" href="classWt_1_1Dbo_1_1Query.html" title="A database query.">Query</a> object, you can keep the query around and run the query multiple times, perhaps with different parameter values or to scroll through the query results.<p>
When using <code><a class="el" href="structWt_1_1Dbo_1_1DirectBinding.html">DirectBinding</a></code>, the query must be specified entirely using the <code>sql</code>, and can be run only once. This method does have the benefit of binding parameters directly to the underlying prepared statement.<p>
This method uses <a class="el" href="structWt_1_1Dbo_1_1query__result__traits.html" title="Traits class for result types.">query_result_traits</a> to unmarshal the query result into the <code>Result</code> type. 
</div>
</div><p>
<a class="anchor" name="42b1d61b66e996eff474d677a10d5b8f"></a><!-- doxytag: member="Wt::Dbo::Session::execute" ref="42b1d61b66e996eff474d677a10d5b8f" args="(const std::string &amp;sql)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classWt_1_1Dbo_1_1Call.html">Call</a> Wt::Dbo::Session::execute           </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&nbsp;</td>
          <td class="paramname"> <em>sql</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Executs an Sql command. 
<p>
This executs an Sql command. It differs from <a class="el" href="classWt_1_1Dbo_1_1Session.html#8712ff0d59f7bb6a4d2986ad9637cc9e" title="Creates a query.">query()</a> in that no result is expected from the call.<p>
Usage example: <div class="fragment"><pre class="fragment"> session.execute(<span class="stringliteral">"update user set name = ? where name = ?"</span>).bind(<span class="stringliteral">"Bart"</span>).bind(<span class="stringliteral">"Sarah"</span>);
</pre></div> 
</div>
</div><p>
<a class="anchor" name="ba79d84c7c91faae06f954e6d3d390ab"></a><!-- doxytag: member="Wt::Dbo::Session::createTables" ref="ba79d84c7c91faae06f954e6d3d390ab" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Wt::Dbo::Session::createTables           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Creates the database schema. 
<p>
This will create the database schema of the mapped tables. Schema creation will fail if one or more tables already existed.<p>
<dl class="see" compact><dt><b>See also:</b></dt><dd><a class="el" href="classWt_1_1Dbo_1_1Session.html#5886d450c052ae0ee15ab3c91e439229" title="Maps a class to a database table.">mapClass()</a>, <a class="el" href="classWt_1_1Dbo_1_1Session.html#4c1fedb21e4e1cc44b182a34e8ebb4ef" title="Drops the database schema.">dropTables()</a> </dd></dl>

</div>
</div><p>
<a class="anchor" name="4c1fedb21e4e1cc44b182a34e8ebb4ef"></a><!-- doxytag: member="Wt::Dbo::Session::dropTables" ref="4c1fedb21e4e1cc44b182a34e8ebb4ef" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Wt::Dbo::Session::dropTables           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Drops the database schema. 
<p>
This will drop the database schema. Dropping the schema will fail if one or more tables did not exist.<p>
<dl class="see" compact><dt><b>See also:</b></dt><dd><a class="el" href="classWt_1_1Dbo_1_1Session.html#ba79d84c7c91faae06f954e6d3d390ab" title="Creates the database schema.">createTables()</a> </dd></dl>

</div>
</div><p>
<a class="anchor" name="b896d119f1e0fb79adffe2282b92ef17"></a><!-- doxytag: member="Wt::Dbo::Session::flush" ref="b896d119f1e0fb79adffe2282b92ef17" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Wt::Dbo::Session::flush           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Flushes the session. 
<p>
This flushes all modified objects to the database. This does not commit the transaction.<p>
Normally, you need not to call this method as the session is flushed automatically before committing a transaction, or before running a query (to be sure to take into account pending modifications). 
</div>
</div><p>
</div>
<hr size="1"><address style="align: right;"><small>
Generated on Fri Sep 10 16:33:04 2010 for <a href="http://www.webtoolkit.eu/wt/">Wt</a> by&nbsp;<a href="http://www.doxygen.org/index.html"><img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.6</small></address>
</body>
</html>
