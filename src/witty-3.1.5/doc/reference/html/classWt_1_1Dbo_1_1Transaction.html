<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Wt: Wt::Dbo::Transaction Class Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.6 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="namespaceWt.html">Wt</a>::<a class="el" href="namespaceWt_1_1Dbo.html">Dbo</a>::<a class="el" href="classWt_1_1Dbo_1_1Transaction.html">Transaction</a>
  </div>
</div>
<div class="contents">
<h1>Wt::Dbo::Transaction Class Reference<br>
<small>
[<a class="el" href="group__dbo.html">Database Objects (Dbo)</a>]</small>
</h1><!-- doxytag: class="Wt::Dbo::Transaction" -->A database transaction.  
<a href="#_details">More...</a>
<p>
<code>#include &lt;Wt/Dbo/Transaction&gt;</code>
<p>

<p>
<a href="classWt_1_1Dbo_1_1Transaction-members.html">List of all members.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWt_1_1Dbo_1_1Transaction.html#d617b2cb23bc0778ad2c534e2482f74c">Transaction</a> (<a class="el" href="classWt_1_1Dbo_1_1Session.html">Session</a> &amp;session)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Constructor.  <a href="#d617b2cb23bc0778ad2c534e2482f74c"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWt_1_1Dbo_1_1Transaction.html#5451291c5485081d047e723f9414fe88">~Transaction</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Destructor.  <a href="#5451291c5485081d047e723f9414fe88"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWt_1_1Dbo_1_1Transaction.html#c1c956890b27b36a7e8ce664606e2af9">isActive</a> () const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns whether the transaction is still active.  <a href="#c1c956890b27b36a7e8ce664606e2af9"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWt_1_1Dbo_1_1Transaction.html#76e109abb03f00cf3ba5a5c6d84529a5">commit</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Commits the transaction.  <a href="#76e109abb03f00cf3ba5a5c6d84529a5"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classWt_1_1Dbo_1_1Transaction.html#071848320ad21e06890fb30d4b6b46e9">rollback</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Rolls back the transaction.  <a href="#071848320ad21e06890fb30d4b6b46e9"></a><br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
A database transaction. 
<p>
This class implements a RAII transaction. Most dbo manipulations require that a transaction is active, and database changes will not be committed to the database until the active transaction is committed using <a class="el" href="classWt_1_1Dbo_1_1Transaction.html#76e109abb03f00cf3ba5a5c6d84529a5" title="Commits the transaction.">commit()</a>.<p>
A transaction is active until it is either committed or rolled back. When a transaction is rolled back or fails, the modified database objects are not successfully synchronized with the database. The in memory database objects remain unchanged so they may possibly be synchronized later in a new transaction.<p>
In most occasions you will want to guard a single method with a transaction object on the stack. Unless the object is committed before returning from the method, the transaction will be rolled back.<p>
You may create multiple (nested) transaction objects at the same time: in this way you can guard a method with a transaction object even if it is called from another method which also defines a transaction with a wider scope. Nested transactions act in concert and reference the same logical transaction: the logical transaction will fail if at least one transaction fails, and will be committed only if all transactions are committed.<p>
Usage example: <div class="fragment"><pre class="fragment"> <span class="keywordtype">void</span> doSomething(<a class="code" href="classWt_1_1Dbo_1_1Session.html" title="A database session.">Wt::Dbo::Session</a>&amp; session)
 {
   <a class="code" href="classWt_1_1Dbo_1_1Transaction.html" title="A database transaction.">Wt::Dbo::Transaction</a> transaction(session);

   <a class="code" href="classWt_1_1Dbo_1_1ptr.html" title="A smart pointer for database objects.">Wt::Dbo::ptr&lt;Account&gt;</a> a = session.<a class="code" href="classWt_1_1Dbo_1_1Session.html#857714c785108435d082bcad10158e68" title="Loads a persisted object.">load</a>&lt;Account&gt;(42);
   ...

   transaction.commit();
 }
</pre></div> <hr><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" name="d617b2cb23bc0778ad2c534e2482f74c"></a><!-- doxytag: member="Wt::Dbo::Transaction::Transaction" ref="d617b2cb23bc0778ad2c534e2482f74c" args="(Session &amp;session)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Wt::Dbo::Transaction::Transaction           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classWt_1_1Dbo_1_1Session.html">Session</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>session</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [explicit]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Constructor. 
<p>
Opens a transaction for the given <code>session</code>. If a transaction is already open for the session, this transaction is added. All open transactions must commit successfully for the entire transaction to succeed. 
</div>
</div><p>
<a class="anchor" name="5451291c5485081d047e723f9414fe88"></a><!-- doxytag: member="Wt::Dbo::Transaction::~Transaction" ref="5451291c5485081d047e723f9414fe88" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Wt::Dbo::Transaction::~Transaction           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Destructor. 
<p>
If the transaction is still active, it is rolled back. 
</div>
</div><p>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="c1c956890b27b36a7e8ce664606e2af9"></a><!-- doxytag: member="Wt::Dbo::Transaction::isActive" ref="c1c956890b27b36a7e8ce664606e2af9" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool Wt::Dbo::Transaction::isActive           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Returns whether the transaction is still active. 
<p>
A transaction is active unless it has been committed or rolled back.<p>
While a transaction is active, new transactions for the same session are treated as nested transactions. 
</div>
</div><p>
<a class="anchor" name="76e109abb03f00cf3ba5a5c6d84529a5"></a><!-- doxytag: member="Wt::Dbo::Transaction::commit" ref="76e109abb03f00cf3ba5a5c6d84529a5" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool Wt::Dbo::Transaction::commit           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Commits the transaction. 
<p>
If this is the last open transaction for the session, the session is flushed and pending changes are committed to the database.<p>
Returns whether the transaction was flushed to the database (i.e. whether this was indeed the last open transaction).<p>
<dl class="see" compact><dt><b>See also:</b></dt><dd><a class="el" href="classWt_1_1Dbo_1_1Transaction.html#071848320ad21e06890fb30d4b6b46e9" title="Rolls back the transaction.">rollback()</a> </dd></dl>

</div>
</div><p>
<a class="anchor" name="071848320ad21e06890fb30d4b6b46e9"></a><!-- doxytag: member="Wt::Dbo::Transaction::rollback" ref="071848320ad21e06890fb30d4b6b46e9" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Wt::Dbo::Transaction::rollback           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Rolls back the transaction. 
<p>
<dl class="see" compact><dt><b>See also:</b></dt><dd><a class="el" href="classWt_1_1Dbo_1_1Transaction.html#76e109abb03f00cf3ba5a5c6d84529a5" title="Commits the transaction.">commit()</a>, <a class="el" href="classWt_1_1Dbo_1_1Transaction.html#5451291c5485081d047e723f9414fe88" title="Destructor.">~Transaction()</a> </dd></dl>

</div>
</div><p>
</div>
<hr size="1"><address style="align: right;"><small>
Generated on Fri Sep 10 16:33:04 2010 for <a href="http://www.webtoolkit.eu/wt/">Wt</a> by&nbsp;<a href="http://www.doxygen.org/index.html"><img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.6</small></address>
</body>
</html>
